@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /* Full-width safety to ensure no layout constrains root/page bars */
  html, body { width: 100%; max-width: 100%; }
  #wpadminbar { left: 0; right: 0; width: 100%; }
}

@layer components {
  /* Mobile header sizing tweaks */
  #site-header .custom-logo{ @apply max-h-10 md:max-h-[50px]; }
  @media (max-width: 480px){
    #site-header .header-inner{ padding-top: 0.5rem; padding-bottom: 0.5rem; }
  }

  /* Prevent main#primary from overflowing viewport on mobile */
  @media (max-width: 768px){
    #primary { max-width: 100vw; overflow-x: clip; }
    @supports not (overflow: clip){
      #primary { overflow-x: hidden; }
    }
  }
  #primary .entry-content, #primary .prose { overflow-wrap: anywhere; word-break: break-word; }
  #primary img, #primary svg, #primary video, #primary iframe, #primary .wp-block-embed__wrapper { max-width: 100%; height: auto; }
  #primary pre { overflow-x: auto; max-width: 100%; }
  #primary code { white-space: pre-wrap; }
  #primary table { display: block; width: 100%; overflow-x: auto; }

  /* Aspect ratio helpers for cards (16:9) */
  .aspect-w-16.aspect-h-9{ position: relative; }
  .aspect-w-16.aspect-h-9::before{ content:""; display:block; padding-top:56.25%; }
  .aspect-w-16.aspect-h-9 > *{ position:absolute; inset:0; }

  /* Desktop dropdown base styles */
  .menu > li > a,
  .menu > li > button {
    @apply text-slate-700 hover:text-slate-900;
  }
  /* Position dropdown relative to parent group */
  .menu > li { @apply relative; }
  .menu li .sub-menu { @apply left-0; }
  .menu li.depth-1 .sub-menu { @apply left-full top-0 ml-2; }
  /* Mega-menu when top-level item has grandchildren */
  .menu > li[data-has-grandchildren="1"] > .sub-menu {
    @apply left-1/2 -translate-x-1/2 w-[min(64rem,90vw)] gap-2 p-4;
  }
  /* Ensure mega submenu displays as grid on focus (no hover) */
  .menu > li[data-has-grandchildren="1"]:focus-within > .sub-menu {
    @apply grid grid-cols-2 md:grid-cols-3;
  }
  /* Defensive: ensure hidden always wins for mega submenu */
  .menu > li[data-has-grandchildren="1"] > .sub-menu.hidden {
    display: none;
  }
  .menu > li[data-has-grandchildren="1"] > .sub-menu > li > a {
    @apply font-semibold text-slate-700 px-2 py-1;
  }
  .menu > li[data-has-grandchildren="1"] > .sub-menu > li > .sub-menu {
    @apply static mt-1 grid grid-cols-1 gap-1 p-0 ml-0 shadow-none ring-0 bg-transparent;
  }
  /* Hide dropdown chevron on first submenu headings within mega-menu */
  .menu > li[data-has-grandchildren="1"] > .sub-menu > li > button svg {
    display: none;
  }
  .menu > li[data-has-grandchildren="1"] > .sub-menu > li > .sub-menu > li > a {
    @apply px-2 py-1 text-sm text-slate-600 hover:text-slate-900;
  }

  /* Dropdown item styles */
  .sub-menu > li > a { @apply block px-3 py-2 text-slate-700 hover:bg-slate-50; }
}

/* Typography defaults for posts */
.prose img {
  @apply rounded;
}
